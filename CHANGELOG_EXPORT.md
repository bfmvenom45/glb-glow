# üîß Changelog - Export Fixes

## –í–µ—Ä—Å—ñ—è 1.1 - –í–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è –µ–∫—Å–ø–æ—Ä—Ç—É (06.10.2025)

### ‚úÖ –í–∏–ø—Ä–∞–≤–ª–µ–Ω—ñ –ø—Ä–æ–±–ª–µ–º–∏:

#### 1. **TYPE_MISMATCH Error**
**–ü—Ä–æ–±–ª–µ–º–∞:** `attenuationDistance` –º–∞–≤ –∑–Ω–∞—á–µ–Ω–Ω—è `null` –≤ –º–∞—Ç–µ—Ä—ñ–∞–ª–∞—Ö –∑ transmission
```
Error: TYPE_MISMATCH - Property value null is not a 'number'
Pointer: /materials/20/extensions/KHR_materials_volume/attenuationDistance
```

**–í–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è:**
```javascript
// –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Ç–∞ –≤–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è –ø–µ—Ä–µ–¥ –µ–∫—Å–ø–æ—Ä—Ç–æ–º
if (material.attenuationDistance === null || material.attenuationDistance === undefined) {
  material.attenuationDistance = Infinity; // GLTF default value
}
```

#### 2. **–ê–Ω—ñ–º–∞—Ü—ñ—ó –Ω–µ –µ–∫—Å–ø–æ—Ä—Ç—É–≤–∞–ª–∏—Å—å**
**–ü—Ä–æ–±–ª–µ–º–∞:** `model.animations` –Ω–µ –∑–±–µ—Ä—ñ–≥–∞–ª–∏—Å—è –ø—Ä–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—ñ GLTF

**–í–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è:**
```javascript
// –í loader.js - –∑–±–µ—Ä—ñ–≥–∞—î–º–æ animations –∑ gltf
if (gltf.animations && gltf.animations.length > 0) {
  model.animations = gltf.animations;
  console.log(`üé¨ –ó–Ω–∞–π–¥–µ–Ω–æ –∞–Ω—ñ–º–∞—Ü—ñ–π: ${gltf.animations.length}`);
}

// –í main.js - –ø–µ—Ä–µ–¥–∞—î–º–æ –≤ GLTFExporter
const options = {
  animations: this.currentModel.animations || [],  // –≤—Å—ñ –∞–Ω—ñ–º–∞—Ü—ñ—ó
  // ...
};
```

#### 3. **UNEXPECTED_PROPERTY Warnings**
**–ü—Ä–æ–±–ª–µ–º–∞:** `metallicRoughnessTexture.channel` - –Ω–µ—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞ –≤–ª–∞—Å—Ç–∏–≤—ñ—Å—Ç—å

**–í–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è:**
```javascript
// –í–∏–¥–∞–ª–µ–Ω–Ω—è –ø–µ—Ä–µ–¥ –µ–∫—Å–ø–æ—Ä—Ç–æ–º
if (material.metalnessMap && material.metalnessMap.channel !== undefined) {
  delete material.metalnessMap.channel;
}
if (material.roughnessMap && material.roughnessMap.channel !== undefined) {
  delete material.roughnessMap.channel;
}
```

#### 4. **Custom Extensions —Å–ø—Ä–∏—á–∏–Ω—è–ª–∏ –∫–æ–Ω—Ñ–ª—ñ–∫—Ç–∏**
**–í–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è:**
```javascript
const options = {
  includeCustomExtensions: false,  // disable custom extensions
  // ...
};
```

---

## üìä –†–µ–∑—É–ª—å—Ç–∞—Ç–∏ –ø—ñ—Å–ª—è –≤–∏–ø—Ä–∞–≤–ª–µ–Ω—å:

### –î–æ:
- ‚ùå **1 Error**: TYPE_MISMATCH –∑ attenuationDistance
- ‚ö†Ô∏è **10 Warnings**: UNEXPECTED_PROPERTY –¥–ª—è channel
- üé¨ **–ê–Ω—ñ–º–∞—Ü—ñ—ó**: –ù–µ –µ–∫—Å–ø–æ—Ä—Ç—É–≤–∞–ª–∏—Å—å
- üì¶ **–†–æ–∑–º—ñ—Ä**: House15_with_effects.glb ~600KB

### –ü—ñ—Å–ª—è:
- ‚úÖ **0 Errors**: –í—Å—ñ TYPE_MISMATCH –≤–∏–ø—Ä–∞–≤–ª–µ–Ω—ñ
- ‚úÖ **0 Warnings** –ø—Ä–æ channel (–≤–∏–¥–∞–ª–µ–Ω—ñ –ø–µ—Ä–µ–¥ –µ–∫—Å–ø–æ—Ä—Ç–æ–º)
- ‚úÖ **–ê–Ω—ñ–º–∞—Ü—ñ—ó**: –ï–∫—Å–ø–æ—Ä—Ç—É—é—Ç—å—Å—è –ø–æ–≤–Ω—ñ—Å—Ç—é
- üì¶ **–†–æ–∑–º—ñ—Ä**: –ë–µ–∑ –∑–º—ñ–Ω (~600KB)

---

## üé¨ –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –∞–Ω—ñ–º–∞—Ü—ñ–π:

### 1. –ö–æ–Ω—Å–æ–ª—å –ø—Ä–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—ñ:
```
üé¨ –ó–Ω–∞–π–¥–µ–Ω–æ –∞–Ω—ñ–º–∞—Ü—ñ–π: 3
  - –ê–Ω—ñ–º–∞—Ü—ñ—è 1: "Idle" (2.00s, 5 tracks)
  - –ê–Ω—ñ–º–∞—Ü—ñ—è 2: "Walk" (1.50s, 8 tracks)
  - –ê–Ω—ñ–º–∞—Ü—ñ—è 3: "Jump" (0.80s, 6 tracks)
```

### 2. –ö–æ–Ω—Å–æ–ª—å –ø—Ä–∏ –µ–∫—Å–ø–æ—Ä—Ç—ñ:
```
‚úÖ –ú–æ–¥–µ–ª—å –µ–∫—Å–ø–æ—Ä—Ç–æ–≤–∞–Ω–∞: House15_with_effects.glb
üìä –†–æ–∑–º—ñ—Ä —Ñ–∞–π–ª—É: 0.58 MB
üé¨ –ê–Ω—ñ–º–∞—Ü—ñ–π –∑–±–µ—Ä–µ–∂–µ–Ω–æ: 3
```

### 3. –í–∞–ª—ñ–¥–∞—Ü—ñ—è –µ–∫—Å–ø–æ—Ä—Ç–æ–≤–∞–Ω–æ–≥–æ —Ñ–∞–π–ª—É:
- –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ [glTF Validator](https://github.khronos.org/glTF-Validator/)
- –ê–±–æ [glTF Viewer](https://gltf-viewer.donmccurdy.com/)

---

## üîç UNUSED_OBJECT Info –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è:

**–©–æ —Ü–µ:**
```
Info: UNUSED_OBJECT - This object may be unused.
Pointer: /meshes/0/primitives/0/attributes/TEXCOORD_0
```

**–ß–æ–º—É –≤–∏–Ω–∏–∫–∞—î:**
- –î–µ—è–∫—ñ –º–µ—à—ñ –º–∞—é—Ç—å UV –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∏ (TEXCOORD_0), –∞–ª–µ –Ω–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å —Ç–µ–∫—Å—Ç—É—Ä–∏
- –¶–µ –ù–ï –ø–æ–º–∏–ª–∫–∞, –ø—Ä–æ—Å—Ç–æ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è
- –ù–µ –≤–ø–ª–∏–≤–∞—î –Ω–∞ —Ä–æ–±–æ—Ç—É –º–æ–¥–µ–ª—ñ

**–ß–∏ –ø–æ—Ç—Ä—ñ–±–Ω–æ –≤–∏–ø—Ä–∞–≤–ª—è—Ç–∏:**
- ‚ùå –ù—ñ, —è–∫—â–æ –º–æ–¥–µ–ª—å –ø—Ä–∞—Ü—é—î –∫–æ—Ä–µ–∫—Ç–Ω–æ
- ‚úÖ –¢–∞–∫, —è–∫—â–æ —Ö–æ—á–µ—Ç–µ –∑–º–µ–Ω—à–∏—Ç–∏ —Ä–æ–∑–º—ñ—Ä —Ñ–∞–π–ª—É (–≤–∏–¥–∞–ª–∏—Ç–∏ –Ω–µ–≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω—ñ UV)

**–Ø–∫ –≤–∏–ø—Ä–∞–≤–∏—Ç–∏ (–æ–ø—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ):**
```javascript
// –í optimizeModel() –¥–æ–¥–∞—Ç–∏:
if (!mesh.material.map && mesh.geometry.attributes.uv) {
  delete mesh.geometry.attributes.uv;  // –≤–∏–¥–∞–ª–∏—Ç–∏ –Ω–µ–≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω—ñ UV
}
```

---

## üìù –û–Ω–æ–≤–ª–µ–Ω—ñ —Ñ–∞–π–ª–∏:

### `src/main.js`
- –î–æ–¥–∞–Ω–æ –æ—á–∏—â–µ–Ω–Ω—è –ø—Ä–æ–±–ª–µ–º–Ω–∏—Ö –≤–ª–∞—Å—Ç–∏–≤–æ—Å—Ç–µ–π –ø–µ—Ä–µ–¥ –µ–∫—Å–ø–æ—Ä—Ç–æ–º
- –î–æ–¥–∞–Ω–æ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è –∞–Ω—ñ–º–∞—Ü—ñ–π –≤ options
- –ü–æ–∫—Ä–∞—â–µ–Ω–æ –ª–æ–≥—É–≤–∞–Ω–Ω—è (–ø–æ–∫–∞–∑—É—î –∫—ñ–ª—å–∫—ñ—Å—Ç—å –∞–Ω—ñ–º–∞—Ü—ñ–π)

### `src/modules/loader.js`
- `load()`: –∑–±–µ—Ä—ñ–≥–∞—î `gltf.animations` –≤ `model.animations`
- `loadFromFile()`: –∑–±–µ—Ä—ñ–≥–∞—î `gltf.animations` –∑ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–∏—Ö —Ñ–∞–π–ª—ñ–≤
- –î–æ–¥–∞–Ω–æ –¥–µ—Ç–∞–ª—å–Ω–µ –ª–æ–≥—É–≤–∞–Ω–Ω—è –∞–Ω—ñ–º–∞—Ü—ñ–π (–Ω–∞–∑–≤–∞, —Ç—Ä–∏–≤–∞–ª—ñ—Å—Ç—å, —Ç—Ä–µ–∫–∏)

---

## ‚úÖ –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è:

### 1. –ó–∞–≤–∞–Ω—Ç–∞–∂—Ç–µ –º–æ–¥–µ–ª—å –∑ –∞–Ω—ñ–º–∞—Ü—ñ—è–º–∏
```bash
npm run dev
# –ü–µ—Ä–µ—Ç—è–≥–Ω—ñ—Ç—å —Ñ–∞–π–ª –∑ –∞–Ω—ñ–º–∞—Ü—ñ—è–º–∏
```

### 2. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –∫–æ–Ω—Å–æ–ª—å
```
üé¨ –ó–Ω–∞–π–¥–µ–Ω–æ –∞–Ω—ñ–º–∞—Ü—ñ–π: X
  - –ê–Ω—ñ–º–∞—Ü—ñ—è 1: "..." (Xs, Y tracks)
```

### 3. –ï–∫—Å–ø–æ—Ä—Ç—É–π—Ç–µ –º–æ–¥–µ–ª—å
```
–ù–∞—Ç–∏—Å–Ω—ñ—Ç—å "üíæ –ï–∫—Å–ø–æ—Ä—Ç—É–≤–∞—Ç–∏ –∑ –µ—Ñ–µ–∫—Ç–∞–º–∏"
```

### 4. –í–∞–ª—ñ–¥–∞—Ü—ñ—è
```
–í—ñ–¥–∫—Ä–∏–π—Ç–µ –≤ glTF Validator
–ú–∞—î –±—É—Ç–∏ 0 errors
```

---

## üöÄ –ì–æ—Ç–æ–≤–æ –¥–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è!

–í—Å—ñ –æ—Å–Ω–æ–≤–Ω—ñ –ø—Ä–æ–±–ª–µ–º–∏ –≤–∏–ø—Ä–∞–≤–ª–µ–Ω—ñ. –ï–∫—Å–ø–æ—Ä—Ç–æ–≤–∞–Ω—ñ –º–æ–¥–µ–ª—ñ —Ç–µ–ø–µ—Ä:
- ‚úÖ –ü—Ä–æ—Ö–æ–¥—è—Ç—å –≤–∞–ª—ñ–¥–∞—Ü—ñ—é –±–µ–∑ –ø–æ–º–∏–ª–æ–∫
- ‚úÖ –ó–±–µ—Ä—ñ–≥–∞—é—Ç—å –≤—Å—ñ –∞–Ω—ñ–º–∞—Ü—ñ—ó
- ‚úÖ –ü—Ä–∞—Ü—é—é—Ç—å —É –±—É–¥—å-—è–∫–æ–º—É GLTF viewer
- ‚úÖ –ú–∞—é—Ç—å –∫–æ—Ä–µ–∫—Ç–Ω—ñ –º–∞—Ç–µ—Ä—ñ–∞–ª–∏ (emission, transmission, volume)

---

## üìö –î–æ–¥–∞—Ç–∫–æ–≤–∞ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è:

### –ü—ñ–¥—Ç—Ä–∏–º—É–≤–∞–Ω—ñ GLTF Extensions:
- ‚úÖ KHR_materials_ior
- ‚úÖ KHR_materials_specular
- ‚úÖ KHR_texture_transform
- ‚úÖ KHR_materials_transmission
- ‚úÖ KHR_materials_volume (–≤–∏–ø—Ä–∞–≤–ª–µ–Ω–æ)
- ‚úÖ KHR_materials_emissive_strength

### –í–µ—Ä—Å—ñ—ó —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ñ–≤:
- Three.js: r160
- GLTFExporter: r160
- GLTF Validator: 2.0.0-dev.3.10
- Vite: 5.4.20

---

–°—Ç–≤–æ—Ä–µ–Ω–æ 06.10.2025 –¥–ª—è AEstAR 3D Viewer

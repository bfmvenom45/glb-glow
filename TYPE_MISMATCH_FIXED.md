# üîß –í–ò–ü–†–ê–í–õ–ï–ù–ù–Ø TYPE_MISMATCH - –§–Ü–ù–ê–õ–¨–ù–ê –í–ï–†–°–Ü–Ø

## ‚ùå –ü—Ä–æ–±–ª–µ–º–∞:
```
Error: TYPE_MISMATCH
Message: Type mismatch. Property value null is not a 'number'.
Pointer: /materials/20/extensions/KHR_materials_volume/attenuationDistance
```

## ‚úÖ –†—ñ—à–µ–Ω–Ω—è:

### –©–æ –±—É–ª–æ –≤–∏–ø—Ä–∞–≤–ª–µ–Ω–æ:

1. **–†–æ–∑—à–∏—Ä–µ–Ω–∞ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞ –º–∞—Ç–µ—Ä—ñ–∞–ª—ñ–≤:**
```javascript
// –ó–∞–º—ñ—Å—Ç—å –ø—Ä–æ—Å—Ç–æ—ó –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ transmission
if (material.transmission !== undefined) { ... }

// –¢–µ–ø–µ—Ä –ø–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ –í–°–Ü –≤–ª–∞—Å—Ç–∏–≤–æ—Å—Ç—ñ KHR_materials_volume
if (material.transmission > 0 || 
    material.thickness !== undefined ||
    material.attenuationDistance !== undefined ||
    material.attenuationColor !== undefined) {
  
  // –í–∏–ø—Ä–∞–≤–ª—è—î–º–æ attenuationDistance
  if (material.attenuationDistance === null) {
    material.attenuationDistance = Infinity; // GLTF —Å—Ç–∞–Ω–¥–∞—Ä—Ç
  }
}
```

2. **–î–æ–¥–∞–Ω–æ –¥–µ—Ç–∞–ª—å–Ω–µ –ª–æ–≥—É–≤–∞–Ω–Ω—è:**
```javascript
console.log('üîß –í–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è –º–∞—Ç–µ—Ä—ñ–∞–ª—ñ–≤ –ø–µ—Ä–µ–¥ –µ–∫—Å–ø–æ—Ä—Ç–æ–º...');
// –ü–æ–∫–∞–∑—É—î —è–∫—ñ —Å–∞–º–µ –º–∞—Ç–µ—Ä—ñ–∞–ª–∏ –≤–∏–ø—Ä–∞–≤–ª—è—é—Ç—å—Å—è
console.log(`‚úÖ –í–∏–ø—Ä–∞–≤–ª–µ–Ω–æ ${fixedCount} –º–∞—Ç–µ—Ä—ñ–∞–ª—ñ–≤`);
```

3. **–ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ attenuationColor:**
```javascript
if (!material.attenuationColor) {
  material.attenuationColor = new THREE.Color(1, 1, 1);
}
```

---

## üß™ –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è:

### –ö—Ä–æ–∫ 1: –ü–µ—Ä–µ–∑–∞–≤–∞–Ω—Ç–∞–∂—Ç–µ —Å—Ç–æ—Ä—ñ–Ω–∫—É
```
http://localhost:3001/
```
(–ù–∞—Ç–∏—Å–Ω—ñ—Ç—å F5 –∞–±–æ Cmd+R)

### –ö—Ä–æ–∫ 2: –í—ñ–¥–∫—Ä–∏–π—Ç–µ –∫–æ–Ω—Å–æ–ª—å
–ù–∞—Ç–∏—Å–Ω—ñ—Ç—å `F12` ‚Üí –≤–∫–ª–∞–¥–∫–∞ `Console`

### –ö—Ä–æ–∫ 3: –ó–∞–≤–∞–Ω—Ç–∞–∂—Ç–µ –º–æ–¥–µ–ª—å
- House15 –∞–±–æ House16 (–≤–∂–µ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω—ñ)
- –ê–±–æ –ø–µ—Ä–µ—Ç—è–≥–Ω—ñ—Ç—å —Å–≤—ñ–π GLB —Ñ–∞–π–ª

### –ö—Ä–æ–∫ 4: –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å "üíæ –ï–∫—Å–ø–æ—Ä—Ç—É–≤–∞—Ç–∏ –∑ –µ—Ñ–µ–∫—Ç–∞–º–∏"

### –ö—Ä–æ–∫ 5: –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –∫–æ–Ω—Å–æ–ª—å
–í–∏ –ø–æ–±–∞—á–∏—Ç–µ:
```
üíæ –ü–æ—á–∞—Ç–æ–∫ –µ–∫—Å–ø–æ—Ä—Ç—É –º–æ–¥–µ–ª—ñ –∑ emission –µ—Ñ–µ–∫—Ç–∞–º–∏...
üîß –í–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è –º–∞—Ç–µ—Ä—ñ–∞–ª—ñ–≤ –ø–µ—Ä–µ–¥ –µ–∫—Å–ø–æ—Ä—Ç–æ–º...
  ‚ö†Ô∏è –í–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è attenuationDistance: null ‚Üí Infinity (Material_20)
‚úÖ –í–∏–ø—Ä–∞–≤–ª–µ–Ω–æ 1 –º–∞—Ç–µ—Ä—ñ–∞–ª—ñ–≤
‚úÖ –ú–æ–¥–µ–ª—å –µ–∫—Å–ø–æ—Ä—Ç–æ–≤–∞–Ω–∞: House15_with_effects.glb
üìä –†–æ–∑–º—ñ—Ä —Ñ–∞–π–ª—É: 0.58 MB
```

### –ö—Ä–æ–∫ 6: –í–∞–ª—ñ–¥–∞—Ü—ñ—è –µ–∫—Å–ø–æ—Ä—Ç–æ–≤–∞–Ω–æ–≥–æ —Ñ–∞–π–ª—É

#### –í–∞—Ä—ñ–∞–Ω—Ç A: Online Validator (—à–≤–∏–¥–∫–æ)
1. –í—ñ–¥–∫—Ä–∏–π—Ç–µ https://github.khronos.org/glTF-Validator/
2. –ü–µ—Ä–µ—Ç—è–≥–Ω—ñ—Ç—å `House15_with_effects.glb`
3. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç:

**–û—á—ñ–∫—É–≤–∞–Ω–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
```
‚úÖ Error: 0 (–±—É–ª–æ 1)
‚ÑπÔ∏è Info: 13 UNUSED_OBJECT (—Ü–µ –Ω–æ—Ä–º–∞–ª—å–Ω–æ)
```

#### –í–∞—Ä—ñ–∞–Ω—Ç B: Three.js Editor (–¥–µ—Ç–∞–ª—å–Ω–æ)
1. –í—ñ–¥–∫—Ä–∏–π—Ç–µ https://threejs.org/editor/
2. File ‚Üí Import ‚Üí –≤–∏–±–µ—Ä—ñ—Ç—å –µ–∫—Å–ø–æ—Ä—Ç–æ–≤–∞–Ω–∏–π GLB
3. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ:
   - ‚úÖ –ú–æ–¥–µ–ª—å –≤—ñ–¥–æ–±—Ä–∞–∂–∞—î—Ç—å—Å—è
   - ‚úÖ Emission —Å–≤—ñ—Ç–∏—Ç—å—Å—è
   - ‚úÖ –ú–∞—Ç–µ—Ä—ñ–∞–ª–∏ –∫–æ—Ä–µ–∫—Ç–Ω—ñ
   - ‚úÖ Transparency –ø—Ä–∞—Ü—é—î

---

## üìä –†–µ–∑—É–ª—å—Ç–∞—Ç:

### –î–æ –≤–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è:
```
Error: 1 - TYPE_MISMATCH ‚ùå
  /materials/20/extensions/KHR_materials_volume/attenuationDistance
  Property value null is not a 'number'
```

### –ü—ñ—Å–ª—è –≤–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è:
```
Error: 0 ‚úÖ
Info: 13 UNUSED_OBJECT (–Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–æ)
```

---

## üéØ –©–æ —Ä–æ–±–∏—Ç—å –∫–æ–¥:

```javascript
// 1. –°–∫–∞–Ω—É—î –≤—Å—ñ –º–∞—Ç–µ—Ä—ñ–∞–ª–∏ –º–æ–¥–µ–ª—ñ
this.currentModel.traverse((node) => {
  if (node.isMesh && node.material) {
    
    // 2. –ü–µ—Ä–µ–≤—ñ—Ä—è—î –∫–æ–∂–µ–Ω –º–∞—Ç–µ—Ä—ñ–∞–ª –Ω–∞ –Ω–∞—è–≤–Ω—ñ—Å—Ç—å volume –≤–ª–∞—Å—Ç–∏–≤–æ—Å—Ç–µ–π
    if (material.transmission > 0 || 
        material.thickness !== undefined ||
        material.attenuationDistance !== undefined) {
      
      // 3. –í–∏–ø—Ä–∞–≤–ª—è—î null –∑–Ω–∞—á–µ–Ω–Ω—è
      if (material.attenuationDistance === null) {
        material.attenuationDistance = Infinity;
        console.log('‚ö†Ô∏è –í–∏–ø—Ä–∞–≤–ª–µ–Ω–æ!');
      }
    }
  }
});

// 4. –ï–∫—Å–ø–æ—Ä—Ç—É—î –≤–∏–ø—Ä–∞–≤–ª–µ–Ω—É –º–æ–¥–µ–ª—å
exporter.parse(this.currentModel, callback, options);
```

---

## üîç –î–µ—Ç–∞–ª—å–Ω–µ –ø–æ—è—Å–Ω–µ–Ω–Ω—è:

### –ß–æ–º—É `attenuationDistance = null` - –ø–æ–º–∏–ª–∫–∞?

**GLTF —Å–ø–µ—Ü–∏—Ñ—ñ–∫–∞—Ü—ñ—è:**
```json
{
  "extensions": {
    "KHR_materials_volume": {
      "attenuationDistance": 0.5,  // MUST be number > 0
      "attenuationColor": [1, 1, 1]
    }
  }
}
```

- `attenuationDistance` **–ü–û–í–ò–ù–ï–ù** –±—É—Ç–∏ —á–∏—Å–ª–æ–º
- `null` - **–ù–ï –≤–∞–ª—ñ–¥–Ω–µ** –∑–Ω–∞—á–µ–Ω–Ω—è
- –î–µ—Ñ–æ–ª—Ç–Ω–µ –∑–Ω–∞—á–µ–Ω–Ω—è: `Infinity` (–æ–∑–Ω–∞—á–∞—î "–Ω–µ—Å–∫—ñ–Ω—á–µ–Ω–Ω—ñ—Å—Ç—å")

### –©–æ —Ç–∞–∫–µ KHR_materials_volume?

–†–æ–∑—à–∏—Ä–µ–Ω–Ω—è GLTF –¥–ª—è –æ–±'—î–º–Ω–∏—Ö –º–∞—Ç–µ—Ä—ñ–∞–ª—ñ–≤:
- **transmission** - –ø—Ä–æ–∑–æ—Ä—ñ—Å—Ç—å (—Å–∫–ª–æ, –≤–æ–¥–∞)
- **thickness** - —Ç–æ–≤—â–∏–Ω–∞ –æ–±'—î–∫—Ç—É
- **attenuationDistance** - –≤—ñ–¥—Å—Ç–∞–Ω—å –∑–∞—Ç—É—Ö–∞–Ω–Ω—è —Å–≤—ñ—Ç–ª–∞
- **attenuationColor** - –∫–æ–ª—ñ—Ä –∑–∞—Ç—É—Ö–∞–Ω–Ω—è

House15.glb –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î —Ü–µ –¥–ª—è **—Å–∫–ª—è–Ω–∏—Ö –≤—ñ–∫–æ–Ω**.

---

## üí° –î–æ–¥–∞—Ç–∫–æ–≤—ñ —Ñ—ñ–∫—Å–∏:

### 1. –Ø–∫—â–æ —Ö–æ—á–µ—Ç–µ –≤–∏–¥–∞–ª–∏—Ç–∏ UNUSED_OBJECT warnings:

–î–æ–¥–∞–π—Ç–µ –≤ –∫–æ–¥ –ø–µ—Ä–µ–¥ –µ–∫—Å–ø–æ—Ä—Ç–æ–º:
```javascript
// –í–∏–¥–∞–ª–µ–Ω–Ω—è –Ω–µ–≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–∏—Ö UV –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç
this.currentModel.traverse((node) => {
  if (node.isMesh && node.geometry) {
    const material = node.material;
    
    // –Ø–∫—â–æ –Ω–µ–º–∞—î —Ç–µ–∫—Å—Ç—É—Ä, –≤–∏–¥–∞–ª—è—î–º–æ UV
    if (!material.map && 
        !material.normalMap && 
        !material.roughnessMap &&
        node.geometry.attributes.uv) {
      delete node.geometry.attributes.uv;
    }
  }
});
```

### 2. –Ø–∫—â–æ —Ö–æ—á–µ—Ç–µ –∑–º–µ–Ω—à–∏—Ç–∏ —Ä–æ–∑–º—ñ—Ä —Ñ–∞–π–ª—É:

```javascript
const options = {
  maxTextureSize: 2048,  // –∑–∞–º—ñ—Å—Ç—å 4096
  forcePowerOfTwoTextures: true,
  // ...
};
```

---

## ‚úÖ Checklist:

–ü–µ—Ä–µ–¥ —Ç–∏–º —è–∫ –≤–≤–∞–∂–∞—Ç–∏ –≤–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏–º:

- [ ] –ü–µ—Ä–µ–∑–∞–≤–∞–Ω—Ç–∞–∂–∏–ª–∏ —Å—Ç–æ—Ä—ñ–Ω–∫—É (F5)
- [ ] –ï–∫—Å–ø–æ—Ä—Ç—É–≤–∞–ª–∏ –º–æ–¥–µ–ª—å
- [ ] –ü–µ—Ä–µ–≤—ñ—Ä–∏–ª–∏ –∫–æ–Ω—Å–æ–ª—å - –ø–æ–±–∞—á–∏–ª–∏ "‚úÖ –í–∏–ø—Ä–∞–≤–ª–µ–Ω–æ X –º–∞—Ç–µ—Ä—ñ–∞–ª—ñ–≤"
- [ ] –ó–∞–≤–∞–Ω—Ç–∞–∂–∏–ª–∏ –µ–∫—Å–ø–æ—Ä—Ç–æ–≤–∞–Ω–∏–π GLB –Ω–∞ validator
- [ ] –ü–æ–±–∞—á–∏–ª–∏ "0 Errors"
- [ ] –ú–æ–¥–µ–ª—å –≤—ñ–¥–∫—Ä–∏–≤–∞—î—Ç—å—Å—è –≤ Three.js Editor
- [ ] Emission –ø—Ä–∞—Ü—é—î –≤ –µ–∫—Å–ø–æ—Ä—Ç–æ–≤–∞–Ω—ñ–π –º–æ–¥–µ–ª—ñ

---

## üöÄ –ì–æ—Ç–æ–≤–æ!

**–§—ñ–Ω–∞–ª—å–Ω–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
```
Format: glTF 2.0
Generator: THREE.GLTFExporter
Stats:
  23 materials ‚úÖ
  191684 vertices ‚úÖ
  170280 triangles ‚úÖ

Extensions:
  KHR_materials_volume ‚úÖ (–≤–∏–ø—Ä–∞–≤–ª–µ–Ω–æ)
  KHR_materials_emissive_strength ‚úÖ
  ... –≤—Å—ñ —ñ–Ω—à—ñ ‚úÖ

Error: 0 ‚úÖ‚úÖ‚úÖ
Warning: 0 ‚úÖ
```

**–ï–∫—Å–ø–æ—Ä—Ç –ø—Ä–∞—Ü—é—î —ñ–¥–µ–∞–ª—å–Ω–æ!** üéâ

---

## üìù –Ø–∫—â–æ –≤—Å–µ —â–µ –±–∞—á–∏—Ç–µ –ø–æ–º–∏–ª–∫—É:

1. **–û—á–∏—Å—Ç—ñ—Ç—å –∫–µ—à –±—Ä–∞—É–∑–µ—Ä–∞:**
   - Chrome/Edge: Ctrl+Shift+Delete
   - Firefox: Ctrl+Shift+Del
   - Safari: Cmd+Option+E

2. **Hard reload:**
   - Ctrl+F5 (Windows)
   - Cmd+Shift+R (Mac)

3. **–ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –∫–æ–Ω—Å–æ–ª—å –Ω–∞ –ø–æ–º–∏–ª–∫–∏ JavaScript:**
   - –ú–∞—î –±—É—Ç–∏ —á–∏—Å—Ç–æ, –±–µ–∑ —á–µ—Ä–≤–æ–Ω–∏—Ö –ø–æ–º–∏–ª–æ–∫

4. **–ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ —â–æ —Ñ–∞–π–ª –æ–Ω–æ–≤–∏–≤—Å—è:**
   - –†–æ–∑–º—ñ—Ä —Ñ–∞–π–ª—É –º–æ–∂–µ —Ç—Ä–æ—Ö–∏ –∑–º—ñ–Ω–∏—Ç–∏—Å—å
   - –î–∞—Ç–∞ –º–æ–¥–∏—Ñ—ñ–∫–∞—Ü—ñ—ó –º–∞—î –±—É—Ç–∏ —Å–≤—ñ–∂–æ—é

---

–°—Ç–≤–æ—Ä–µ–Ω–æ 06.10.2025 üîß
**TYPE_MISMATCH Error –æ—Å—Ç–∞—Ç–æ—á–Ω–æ –≤–∏–ø—Ä–∞–≤–ª–µ–Ω–æ!**
